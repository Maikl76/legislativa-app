<h2>Seznam legislativn√≠ch dokument≈Ø</h2>

<!-- Tabulka s dokumenty -->
<table border="1">
    <tr>
        {% for source in sources %}
            <th>{{ source }}</th>
        {% endfor %}
    </tr>
    <tr>
        {% for source in sources %}
            <td>
                <ul>
                    {% for document in documents %}
                        {% if document["Odkaz na zdroj"] == source %}
                            <li>
                                <a href="{{ document['Soubor'] }}" target="_blank">{{ document["N√°zev dokumentu"] }}</a>
                                <span style="color: {% if document_status.get(document['N√°zev dokumentu']) == 'Nov√Ω ‚úÖ' %}green{% elif document_status.get(document['N√°zev dokumentu']) == 'Aktualizov√°no üü°' %}orange{% else %}gray{% endif %};">
                                    {{ document_status.get(document["N√°zev dokumentu"], "Beze zmƒõny ‚ö™") }}
                                </span>
                            </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </td>
        {% endfor %}
    </tr>
</table>

<!-- Vyhled√°v√°n√≠ -->
<h2>Vyhled√°v√°n√≠ v dokumentech</h2>
<form id="searchForm">
    <input type="text" id="searchQuery" placeholder="Zadejte hledan√© slovo" required>
    <button type="submit">Hledat</button>
</form>

<!-- V√Ωsledky hled√°n√≠ -->
<div id="searchResults" style="border:1px solid #ccc; padding:10px; margin-top:20px; display:none;">
    <h3>V√Ωsledky hled√°n√≠:</h3>
    <ul id="resultsList"></ul>
</div>

<!-- JavaScript pro vyhled√°v√°n√≠ -->
<script>
document.getElementById("searchForm").addEventListener("submit", function(event) {
    event.preventDefault();
    let query = document.getElementById("searchQuery").value;
    
    fetch("/search", {
        method: "POST",
        body: new URLSearchParams({ query: query }),
        headers: { "Content-Type": "application/x-www-form-urlencoded" }
    })
    .then(response => response.json())
    .then(results => {
        let resultsList = document.getElementById("resultsList");
        resultsList.innerHTML = "";

        if (results.error) {
            resultsList.innerHTML = `<li style="color:red;">${results.error}</li>`;
        } else if (results.length === 0) {
            resultsList.innerHTML = `<li style="color:gray;">Nenalezen ≈æ√°dn√Ω v√Ωsledek.</li>`;
        } else {
            results.forEach(result => {
                let li = document.createElement("li");
                li.innerHTML = `<b>${result.document}</b> (<a href="${result.source}" target="_blank">Zdroj</a>): <br> "${result.text}"`;
                resultsList.appendChild(li);
            });
        }

        document.getElementById("searchResults").style.display = "block";
    });
});
</script>
